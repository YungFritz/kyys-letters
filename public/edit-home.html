<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Admin — Éditer l’accueil</title>
  <link rel="stylesheet" href="/styles/base.css"/>
  <style>
    .wrap{max-width:1100px;margin:22px auto;padding:0 16px}
    .grid2{display:grid;grid-template-columns:1fr 1fr;gap:18px}
    .preview{border:1px solid var(--border);border-radius:12px;background:#0f1012;display:grid;place-items:center;color:var(--muted);min-height:220px}
    .preview img{max-width:100%;border-radius:12px}
  </style>
</head>
<body>
  <div class="header">
    <div class="bar">
      <div class="brand">K</div>
      <div class="badge">Admin</div>
      <div class="right"><a class="btn" href="/admin.html">Panneau</a></div>
    </div>
  </div>
  <div class="wrap">
    <div class="card">
      <h2 style="margin:0 0 12px 0">Éditer l’accueil</h2>
      <div class="grid2">
        <div>
          <div class="label">Image #1</div>
          <div id="prev1" class="preview">—</div>
          <input id="img1" type="file" accept="image/*" style="margin-top:6px;width:100%" />
        </div>
        <div>
          <div class="label">Image #2</div>
          <div id="prev2" class="preview">—</div>
          <input id="img2" type="file" accept="image/*" style="margin-top:6px;width:100%" />
        </div>
      </div>
      <div style="margin-top:12px">
        <button id="save" class="btn acc">Sauvegarder</button>
        <button id="clear" class="btn danger" style="margin-left:8px">Effacer</button>
      </div>
      <div id="msg" class="label" style="margin-top:8px"></div>
    </div>
  </div>
  <footer>© 2025 — Kyy’s Letters</footer>
  <script src="/js/storage.js"></script>
  <script>
    // Redirection si non connecté
    if (!KyyStore.isLogged()) {
      location.href = '/';
    }
    const prev1 = document.getElementById('prev1');
    const prev2 = document.getElementById('prev2');
    let img1Data = localStorage.getItem('home_img1') || '';
    let img2Data = localStorage.getItem('home_img2') || '';
    function updatePreviews() {
      prev1.innerHTML = img1Data ? `<img src="${img1Data}" alt="">` : '—';
      prev2.innerHTML = img2Data ? `<img src="${img2Data}" alt="">` : '—';
    }
    updatePreviews();
    document.getElementById('img1').onchange = e => {
      const f = e.target.files[0];
      if (!f) return;
      const r = new FileReader();
      r.onload = () => { img1Data = String(r.result || ''); updatePreviews(); };
      r.readAsDataURL(f);
    };
    document.getElementById('img2').onchange = e => {
      const f = e.target.files[0];
      if (!f) return;
      const r = new FileReader();
      r.onload = () => { img2Data = String(r.result || ''); updatePreviews(); };
      r.readAsDataURL(f);
    };
    document.getElementById('save').onclick = () => {
      localStorage.setItem('home_img1', img1Data);
      localStorage.setItem('home_img2', img2Data);
      document.getElementById('msg').textContent = 'Images enregistrées ✅';
    };
    document.getElementById('clear').onclick = () => {
      img1Data = '';
      img2Data = '';
      localStorage.removeItem('home_img1');
      localStorage.removeItem('home_img2');
      updatePreviews();
      document.getElementById('msg').textContent = 'Images supprimées.';
    };
  </script>
</body>
</html>
