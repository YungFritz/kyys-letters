<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Personnelle — Kyy’s Letters</title>
  <link rel="stylesheet" href="/styles/base.css" />
  <style>
    .wrap{max-width:980px;margin:22px auto;padding:0 16px}
    .grid-mem{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:16px}
    .member{background:linear-gradient(180deg,var(--panel),var(--panel-2));border:1px solid var(--border);border-radius:14px;overflow:hidden;text-align:center;padding:14px}
    .member img{width:100%;height:220px;object-fit:cover;border-radius:10px;margin-bottom:10px}
    .member h3{margin:0;font-weight:800}
    .member p{margin:6px 0;color:var(--muted)}
  </style>
</head>
<body>
  <div class="header">
    <div class="bar">
      <div class="brand">K</div>
      <div class="badge">Équipe</div>
      <div class="right">
        <a class="btn" href="/">Accueil</a>
        <!-- Les classes btn-profil et btn-edit permettent de masquer ces boutons si l'utilisateur n'est pas connecté -->
        <a class="btn btn-profil" href="/admin-add-profil.html">+ Profil</a>
        <a class="btn btn-edit" href="/admin-edit-profil.html">Éditer</a>
      </div>
    </div>
  </div>

  <div class="wrap">
    <div class="card">
      <h1 style="margin:0 0 14px 0">Équipe</h1>
      <div id="members" class="grid-mem"></div>
      <div id="empty" class="empty" style="display:none">Aucun profil enregistré.</div>
    </div>
  </div>

  <footer>© 2025 — Kyy’s Letters</footer>

  <!-- Chargement de la bibliothèque de stockage -->
  <!-- Utilise le script de stockage dans /js pour assurer le chargement correct des fonctions -->
  <script src="/js/storage.js"></script>
  <script>
    // Masquer les boutons + Profil et Éditer si aucun utilisateur n'est connecté
    if (!KyyStore.isLogged()) {
      document.querySelectorAll('.btn-profil, .btn-edit').forEach(el => {
        el.style.display = 'none';
      });
    }

    // Charger la liste des membres depuis localStorage ou KyyStore
    const list = JSON.parse(localStorage.getItem('kl_members') || '[]');
    const box = document.getElementById('members');
    const empty = document.getElementById('empty');
    if (!list.length) {
      empty.style.display = 'grid';
    } else {
      for (const m of list) {
        const card=document.createElement('div');
        card.className='member';
        card.innerHTML=`
          <img src="${m.photo || '/placeholder.png'}" alt="${m.name}"/>
          <h3>${m.name || 'Sans nom'}</h3>
          <p>${m.role || 'Rôle non défini'}</p>
          ${m.bio ? `<p class="muted">${m.bio}</p>`:''}
          ${m.contact ? `<p class="muted">${m.contact}</p>`:''}
        `;
        box.appendChild(card);
      }
    }
  </script>
</body>
</html>
